<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://www.elcodi.io/cookbook/implementation/implement-a-form-type/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Implement a form type - Elcodi Documentation</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">

        <link href="../../../css/elcodi.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../.."><img src="../../../img/elcodi.png" height="30" /></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                
                
                
                    
                        <li >
                            <a href="../../../quick-start/">Quick start</a>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Book <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../../book/cart-architecture/">Cart architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/category-architecture/">Category architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/commands/">Commands</a>
</li>

                            
                                
<li >
    <a href="../../../book/coupon-architecture/">Coupon architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/dictionary/">Dictionary</a>
</li>

                            
                                
<li >
    <a href="../../../book/emails/">Emails</a>
</li>

                            
                                
<li >
    <a href="../../../book/events/">Events</a>
</li>

                            
                                
<li >
    <a href="../../../book/features/">Features</a>
</li>

                            
                                
<li >
    <a href="../../../book/">Home</a>
</li>

                            
                                
<li >
    <a href="../../../book/payments/">Payments</a>
</li>

                            
                                
<li >
    <a href="../../../book/philosophy/">Philosophy</a>
</li>

                            
                                
<li >
    <a href="../../../book/plugins/">Plugins</a>
</li>

                            
                                
<li >
    <a href="../../../book/processes/">Processes</a>
</li>

                            
                                
<li >
    <a href="../../../book/product-architecture/">Product architecture</a>
</li>

                            
                                
<li >
    <a href="../../../book/pull-requests/">Pull requests</a>
</li>

                            
                                
<li >
    <a href="../../../book/roadmap/">Roadmap</a>
</li>

                            
                                
<li >
    <a href="../../../book/running-test-suite/">Running test suite</a>
</li>

                            
                                
<li >
    <a href="../../../book/shipping/">Shipping</a>
</li>

                            
                                
<li >
    <a href="../../../book/standards/">Standards</a>
</li>

                            
                                
<li >
    <a href="../../../book/templates/">Templates</a>
</li>

                            
                                
<li >
    <a href="../../../book/translate-elcodi/">Translate elcodi</a>
</li>

                            
                                
<li >
    <a href="../../../book/vagrant-quick-start/">Vagrant quick start</a>
</li>

                            
                                
<li >
    <a href="../../../book/what-is-elcodi/">What is elcodi</a>
</li>

                            
                                
<li >
    <a href="../../../book/why-elcodi/">Why elcodi</a>
</li>

                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown active">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../">Home</a>
</li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Installation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../installation/install-a-plugin/">Install a plugin</a>
</li>

        
            
<li >
    <a href="../../installation/install-dependent-bundles/">Install dependent bundles</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Overwrite</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../overwrite/overwrite-a-parameter/">Overwrite a parameter</a>
</li>

        
            
<li >
    <a href="../../overwrite/overwrite-a-service/">Overwrite a service</a>
</li>

        
            
<li >
    <a href="../../overwrite/overwrite-an-entity/">Overwrite an entity</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Deprecation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../deprecation/deprecate-a-method/">Deprecate a method</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Adapters</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../adapters/currency-rates-populator/">Currency rates populator</a>
</li>

        
            
<li >
    <a href="../../adapters/image-resize/">Image resize</a>
</li>

        
            
<li >
    <a href="../../adapters/location-loader/">Location loader</a>
</li>

        
            
<li >
    <a href="../../adapters/location-populator/">Location populator</a>
</li>

        
            
<li >
    <a href="../../adapters/location-provider/">Location provider</a>
</li>

        
            
<li >
    <a href="../../adapters/metric-bucket/">Metric bucket</a>
</li>

        
            
<li >
    <a href="../../adapters/related-purchasables-provider/">Related purchasables provider</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Workflow</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../workflow/create-automatic-coupon/">Create automatic coupon</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Usage</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../usage/elcodi-watermark/">Elcodi watermark</a>
</li>

        
            
<li >
    <a href="../../usage/referrer-domain/">Referrer domain</a>
</li>

        
    </ul>
  </li>

                            
                                
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Implementation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../implement-a-collector/">Implement a collector</a>
</li>

        
            
<li >
    <a href="../implement-a-controller-and-a-command/">Implement a controller and a command</a>
</li>

        
            
<li >
    <a href="../implement-a-factory/">Implement a factory</a>
</li>

        
            
<li class="active">
    <a href="./">Implement a form type</a>
</li>

        
            
<li >
    <a href="../implement-a-repository/">Implement a repository</a>
</li>

        
            
<li >
    <a href="../implement-an-entity/">Implement an entity</a>
</li>

        
            
<li >
    <a href="../implement-an-event-listener/">Implement an event listener</a>
</li>

        
    </ul>
  </li>

                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Component <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
<li >
    <a href="../../../component/entity-translator/">Entity translator</a>
</li>

                            
                                
<li >
    <a href="../../../component/">Home</a>
</li>

                            
                                
<li >
    <a href="../../../component/media/">Media</a>
</li>

                            
                                
<li >
    <a href="../../../component/menu/">Menu</a>
</li>

                            
                                
<li >
    <a href="../../../component/metrics/">Metrics</a>
</li>

                            
                                
<li >
    <a href="../../../component/sitemap/">Sitemap</a>
</li>

                            
                                
<li >
    <a href="../../../component/state-transition-machine/">State transition machine</a>
</li>

                            
                                
<li >
    <a href="../../../component/template/">Template</a>
</li>

                            
                            </ul>
                        </li>
                    
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../implement-a-factory/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../implement-a-repository/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/elcodi/docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#how-to-implement-a-form-type">How to Implement a Form Type</a></li>
        
            <li><a href="#scenario">Scenario</a></li>
        
            <li><a href="#solution">Solution</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="how-to-implement-a-form-type">How to Implement a Form Type<a class="headerlink" href="#how-to-implement-a-form-type" title="Permanent link"> #</a></h1>
<p>A FormType object in Elcodi ecosystem must follow some rules in order to comply
with the project flexibility.</p>
<h2 id="scenario">Scenario<a class="headerlink" href="#scenario" title="Permanent link"> #</a></h2>
<p>We need to manage one of our own new entities. We have created the entity, the
form and the repository, so we need to create some extra pages in our admin
panel in order to create, modify and delete them.</p>
<p>In order to create these new pages, we need some mechanism to create these 
forms, being able to do it properly and extensible, following the best Symfony 
and Elcodi standards.</p>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link"> #</a></h2>
<p>As you may know, whenever we want to work with forms in Symfony, best practices 
say that we should use FormType classes. These classes are meant to be a PHP 
representation of how a form should be treated and defined.</p>
<p>So let's use them.</p>
<h3 id="symfony-forms">Symfony Forms<a class="headerlink" href="#symfony-forms" title="Permanent link"> #</a></h3>
<p>Symfony Forms is not a Elcodi-related implementation, so first of all you should
know as much as possible about how Symfony Forms works.</p>
<p>We strongly encourage you to learn about them in their documentation before 
proceeding with our specific documentation.</p>
<p><a href="http://symfony.com/doc/current/book/forms.html">Symfony Book - Forms</a>
<a href="http://symfony.com/doc/current/best_practices/forms.html">Symfony Best Practices - Forms</a></p>
<h3 id="using-factories">Using Factories<a class="headerlink" href="#using-factories" title="Permanent link"> #</a></h3>
<p>Remember that every single entity must be created via its factory in Elcodi
Bundles. For more information, please see <a href="http://elcodi.io/docs/cookbook/implementation/implement-a-factory/">Factories</a>. 
In order to use this feature in Symfony Form Types, we must inject always the 
related entity factory.</p>
<pre><code class="php">use Elcodi\Component\Core\Factory\Abstracts\AbstractFactory;

/**
 * @var AbstractFactory
 *
 * Factory
 */
protected $factory;

/**
 * Sets Factory
 *
 * @param AbstractFactory $factory Factory
 *
 * @return $this Self object
 */
public function setFactory(AbstractFactory $factory)
{
    $this-&gt;factory = $factory;

    return $this;
}
</code></pre>

<p>After the factory is injected, we can use it in our FormType specification for
defining the <code>empty_data</code> value and the <code>data_class</code>.</p>
<pre><code class="php">/**
 * Default form options
 *
 * @param OptionsResolverInterface $resolver
 *
 * @return array With the options
 */
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver-&gt;setDefaults([
        'empty_data' =&gt; function () {
            $this
                -&gt;factory
                -&gt;create();
        },
        'data_class' =&gt; $this
            -&gt;factory
            -&gt;getEntityNamespace(),
    ]);
}
</code></pre>

<p>In order to make things easier, there is a Trait in the package <code>elcodi/core</code>, 
designed as a Factory container. To use it, just add it in your class, like any
other trait, and you will be able to use the <code>$this-&gt;factory</code> in your class.</p>
<pre><code class="php">use Elcodi\Component\Core\Factory\Traits\FactoryTrait;

/**
 * Class BannerType
 */
class BannerType extends AbstractType
{
    use FactoryTrait;

    /**
     * Default form options
     *
     * @param OptionsResolverInterface $resolver
     *
     * @return array With the options
     */
    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver-&gt;setDefaults([
            'empty_data' =&gt; function () {
                $this
                    -&gt;factory
                    -&gt;create();
            },
            'data_class' =&gt; $this
                -&gt;factory
                -&gt;getEntityNamespace(),
        ]);
    }
}
</code></pre>

<h3 id="using-namespaces">Using namespaces<a class="headerlink" href="#using-namespaces" title="Permanent link"> #</a></h3>
<p>If your FormType has any kind of relation with another entity, you will need to
define this relation using a namespace. In order to comply again with the
flexibility, we need to inject all namespaces using the entity manager 
parameter.</p>
<p>These namespaces in Elcodi must be injected through the class constructor.</p>
<pre><code class="php">/**
 * Class BannerType
 */
class BannerType extends AbstractType
{
    use FactoryTrait;

    /**
     * @var string
     *
     * Image namespace
     */
    protected $imageNamespace;

    /**
     * Construct
     *
     * @param string $imageNamespace Image namespace
     */
    public function __construct($imageNamespace)
    {
        $this-&gt;imageNamespace = $imageNamespace;
    }

    /**
     * buildForm function
     *
     * @param FormBuilderInterface $builder the formBuilder
     * @param array                $options the options for this form
     */
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            -&gt;add('image', 'entity', [
                'class'    =&gt; $this-&gt;imageNamespace,
                'required' =&gt; false,
                'label'    =&gt; 'image',
                'multiple' =&gt; false,
            ]);
    }
}
</code></pre>

<h3 id="formtype-as-a-service">FormType as a service<a class="headerlink" href="#formtype-as-a-service" title="Permanent link"> #</a></h3>
<p>We are using dependencies in our FormTypes, so remember that we need to define 
our classes as services.</p>
<pre><code class="yaml">services:

    #
    # Form Types
    #
    elcodi.admin.banner.form_type.banner:
        class: Elcodi\Admin\BannerBundle\Form\Type\BannerType
        arguments:
            - %elcodi.entity.image.class%
        calls:
            - [setFactory, [@elcodi.factory.banner]]
        tags:
            - { name: form.type, alias: elcodi_admin_banner_form_type_banner }
</code></pre>

<p>The alias of the FormType must be the same as the value returned by the method
<code>getName()</code> of the class</p>
<pre><code class="php">/**
 * Return unique name for this form
 *
 * @return string
 */
public function getName()
{
    return 'elcodi_admin_banner_form_type_banner';
}
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
                <p>Copyright Â© 2014/2015 <a href="http://www.elcodi.io">Elcodi</a>. All rights reserved.</p>
            
        </footer>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
